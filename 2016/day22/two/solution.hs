import Data.List
import GHC.Stack

data Node = Node Int Int Int Int Int Int Int deriving (Show, Eq)

--            X Y   Size Used Avail  Use%
start :: [Node]
start = [Node 0 0     85   72    13   84 0,
         Node 0 1     89   73    16   82 0,
         Node 0 2     85   68    17   80 0,
         Node 0 3     90   66    24   73 0,
         Node 0 4     92   65    27   70 0,
         Node 0 5     85   68    17   80 0,
         Node 0 6     85   66    19   77 0,
         Node 0 7     89   73    16   82 0,
         Node 0 8     93   64    29   68 0,
         Node 0 9     90   72    18   80 0,
         Node 0 10    89   72    17   80 0,
         Node 0 11    94   73    21   77 0,
         Node 0 12    90   69    21   76 0,
         Node 0 13    91   66    25   72 0,
         Node 0 14    92   73    19   79 0,
         Node 0 15    92   65    27   70 0,
         Node 0 16    92   70    22   76 0,
         Node 0 17    86   73    13   84 0,
         Node 0 18    89   73    16   82 0,
         Node 0 19    94   73    21   77 0,
         Node 0 20    88   72    16   81 0,
         Node 0 21    93   72    21   77 0,
         Node 0 22    85   66    19   77 0,
         Node 0 23    94   68    26   72 0,
         Node 0 24    87   64    23   73 0,
         Node 0 25    92   68    24   73 0,
         Node 0 26    91   68    23   74 0,
         Node 0 27    87   72    15   82 0,
         Node 0 28    90   65    25   72 0,
         Node 0 29    87   70    17   80 0,
         Node 1 0     92   69    23   75 0,
         Node 1 1     92   67    25   72 0,
         Node 1 2     94   72    22   76 0,
         Node 1 3     89   72    17   80 0,
         Node 1 4     90   65    25   72 0,
         Node 1 5     94   67    27   71 0,
         Node 1 6     86   68    18   79 0,
         Node 1 7     93   70    23   75 0,
         Node 1 8     90   67    23   74 0,
         Node 1 9     93   64    29   68 0,
         Node 1 10    87   71    16   81 0,
         Node 1 11    85   70    15   82 0,
         Node 1 12    90   65    25   72 0,
         Node 1 13    91   65    26   71 0,
         Node 1 14    87   65    22   74 0,
         Node 1 15    88   64    24   72 0,
         Node 1 16    90   65    25   72 0,
         Node 1 17    88   73    15   82 0,
         Node 1 18    93   65    28   69 0,
         Node 1 19    89   70    19   78 0,
         Node 1 20    92   72    20   78 0,
         Node 1 21    86   70    16   81 0,
         Node 1 22    92   73    19   79 0,
         Node 1 23    94   64    30   68 0,
         Node 1 24    94   67    27   71 0,
         Node 1 25    93   71    22   76 0,
         Node 1 26    92   71    21   77 0,
         Node 1 27    94   66    28   70 0,
         Node 1 28    91   69    22   75 0,
         Node 1 29    89   67    22   75 0,
         Node 2 0     93   65    28   69 0,
         Node 2 1     86   67    19   77 0,
         Node 2 2     92   66    26   71 0,
         Node 2 3     89   72    17   80 0,
         Node 2 4     89   70    19   78 0,
         Node 2 5     85   73    12   85 0,
         Node 2 6     89   69    20   77 0,
         Node 2 7     86   72    14   83 0,
         Node 2 8     90   70    20   77 0,
         Node 2 9     88   72    16   81 0,
         Node 2 10    88   72    16   81 0,
         Node 2 11    88   70    18   79 0,
         Node 2 12    94   67    27   71 0,
         Node 2 13    94   64    30   68 0,
         Node 2 14    93   66    27   70 0,
         Node 2 15    90   71    19   78 0,
         Node 2 16    85   66    19   77 0,
         Node 2 17    94   73    21   77 0,
         Node 2 18    93   73    20   78 0,
         Node 2 19    85   68    17   80 0,
         Node 2 20    86   73    13   84 0,
         Node 2 21    86   73    13   84 0,
         Node 2 22    94   65    29   69 0,
         Node 2 23    92   71    21   77 0,
         Node 2 24    87   65    22   74 0,
         Node 2 25    93   65    28   69 0,
         Node 2 26    89   69    20   77 0,
         Node 2 27    94   66    28   70 0,
         Node 2 28    91   66    25   72 0,
         Node 2 29    89   66    23   74 0,
         Node 3 0     91   71    20   78 0,
         Node 3 1     93   65    28   69 0,
         Node 3 2     86   64    22   74 0,
         Node 3 3     94   71    23   75 0,
         Node 3 4     93   67    26   72 0,
         Node 3 5     88   72    16   81 0,
         Node 3 6     93   68    25   73 0,
         Node 3 7     85   64    21   75 0,
         Node 3 8     94   69    25   73 0,
         Node 3 9     94   65    29   69 0,
         Node 3 10    88   68    20   77 0,
         Node 3 11    88   72    16   81 0,
         Node 3 12    93   68    25   73 0,
         Node 3 13    93   68    25   73 0,
         Node 3 14    94   64    30   68 0,
         Node 3 15    87   65    22   74 0,
         Node 3 16    93   72    21   77 0,
         Node 3 17    92   64    28   69 0,
         Node 3 18    89   70    19   78 0,
         Node 3 19    93   67    26   72 0,
         Node 3 20    90   70    20   77 0,
         Node 3 21    91   72    19   79 0,
         Node 3 22    88   70    18   79 0,
         Node 3 23    89   64    25   71 0,
         Node 3 24    90   64    26   71 0,
         Node 3 25    91   65    26   71 0,
         Node 3 26    92   65    27   70 0,
         Node 3 27    86   65    21   75 0,
         Node 3 28    94   72    22   76 0,
         Node 3 29    88   65    23   73 0,
         Node 4 0     90   71    19   78 0,
         Node 4 1     91   68    23   74 0,
         Node 4 2     90   72    18   80 0,
         Node 4 3     87   71    16   81 0,
         Node 4 4     94   67    27   71 0,
         Node 4 5     93   71    22   76 0,
         Node 4 6     91   71    20   78 0,
         Node 4 7     86   66    20   76 0,
         Node 4 8     94   71    23   75 0,
         Node 4 9     93   70    23   75 0,
         Node 4 10    89   66    23   74 0,
         Node 4 11    87   68    19   78 0,
         Node 4 12    91   64    27   70 0,
         Node 4 13    91   67    24   73 0,
         Node 4 14    90   68    22   75 0,
         Node 4 15    85   65    20   76 0,
         Node 4 16    86   73    13   84 0,
         Node 4 17    85   69    16   81 0,
         Node 4 18    88   73    15   82 0,
         Node 4 19    88   69    19   78 0,
         Node 4 20    90   73    17   81 0,
         Node 4 21    91   71    20   78 0,
         Node 4 22    86   71    15   82 0,
         Node 4 23    91   66    25   72 0,
         Node 4 24    93   72    21   77 0,
         Node 4 25    86   66    20   76 0,
         Node 4 26    85   66    19   77 0,
         Node 4 27    89   67    22   75 0,
         Node 4 28    87   68    19   78 0,
         Node 4 29    87   73    14   83 0,
         Node 5 0     89   73    16   82 0,
         Node 5 1     85   70    15   82 0,
         Node 5 2     89   65    24   73 0,
         Node 5 3     85   66    19   77 0,
         Node 5 4     91   69    22   75 0,
         Node 5 5     90   70    20   77 0,
         Node 5 6     91   67    24   73 0,
         Node 5 7     89   67    22   75 0,
         Node 5 8     94   66    28   70 0,
         Node 5 9     91   64    27   70 0,
         Node 5 10    89   73    16   82 0,
         Node 5 11    91   64    27   70 0,
         Node 5 12    85   67    18   78 0,
         Node 5 13    93   73    20   78 0,
         Node 5 14    87   69    18   79 0,
         Node 5 15    91   71    20   78 0,
         Node 5 16    91   72    19   79 0,
         Node 5 17    89   72    17   80 0,
         Node 5 18    93   72    21   77 0,
         Node 5 19    86   64    22   74 0,
         Node 5 20    89   65    24   73 0,
         Node 5 21    92   66    26   71 0,
         Node 5 22    87   67    20   77 0,
         Node 5 23    89   64    25   71 0,
         Node 5 24    91   73    18   80 0,
         Node 5 25    92   71    21   77 0,
         Node 5 26    86   68    18   79 0,
         Node 5 27    86   64    22   74 0,
         Node 5 28    88   69    19   78 0,
         Node 5 29    88   71    17   80 0,
         Node 6 0     90   69    21   76 0,
         Node 6 1     88   68    20   77 0,
         Node 6 2     90   69    21   76 0,
         Node 6 3     91   67    24   73 0,
         Node 6 4     94   64    30   68 0,
         Node 6 5     92   67    25   72 0,
         Node 6 6     86   68    18   79 0,
         Node 6 7     92   73    19   79 0,
         Node 6 8     89   71    18   79 0,
         Node 6 9     94   67    27   71 0,
         Node 6 10    89   67    22   75 0,
         Node 6 11    90   68    22   75 0,
         Node 6 12    91   66    25   72 0,
         Node 6 13    92   72    20   78 0,
         Node 6 14    85   68    17   80 0,
         Node 6 15    90   64    26   71 0,
         Node 6 16    91   71    20   78 0,
         Node 6 17    89   71    18   79 0,
         Node 6 18    92   69    23   75 0,
         Node 6 19    94   71    23   75 0,
         Node 6 20    91   67    24   73 0,
         Node 6 21    91   71    20   78 0,
         Node 6 22    85   70    15   82 0,
         Node 6 23    93   65    28   69 0,
         Node 6 24    90   73    17   81 0,
         Node 6 25    92   65    27   70 0,
         Node 6 26    86   66    20   76 0,
         Node 6 27    94   71    23   75 0,
         Node 6 28    89   64    25   71 0,
         Node 6 29    90   67    23   74 0,
         Node 7 0     89   64    25   71 0,
         Node 7 1     91   69    22   75 0,
         Node 7 2     93   66    27   70 0,
         Node 7 3     89   65    24   73 0,
         Node 7 4     93   70    23   75 0,
         Node 7 5     87   71    16   81 0,
         Node 7 6     85   64    21   75 0,
         Node 7 7     93   68    25   73 0,
         Node 7 8     92   68    24   73 0,
         Node 7 9     93   71    22   76 0,
         Node 7 10    89   70    19   78 0,
         Node 7 11    89   69    20   77 0,
         Node 7 12    90   72    18   80 0,
         Node 7 13    88   65    23   73 0,
         Node 7 14    85   67    18   78 0,
         Node 7 15    92   67    25   72 0,
         Node 7 16    91   73    18   80 0,
         Node 7 17    91   69    22   75 0,
         Node 7 18    87   73    14   83 0,
         Node 7 19    94   73    21   77 0,
         Node 7 20    92   65    27   70 0,
         Node 7 21    88   66    22   75 0,
         Node 7 22    89   73    16   82 0,
         Node 7 23    92   65    27   70 0,
         Node 7 24    91   69    22   75 0,
         Node 7 25    92   68    24   73 0,
         Node 7 26    86   73    13   84 0,
         Node 7 27    85   68    17   80 0,
         Node 7 28    86   70    16   81 0,
         Node 7 29    89   66    23   74 0,
         Node 8 0     94   71    23   75 0,
         Node 8 1     91   72    19   79 0,
         Node 8 2     93   68    25   73 0,
         Node 8 3     88   70    18   79 0,
         Node 8 4     93   66    27   70 0,
         Node 8 5     92   68    24   73 0,
         Node 8 6     88   71    17   80 0,
         Node 8 7     91   67    24   73 0,
         Node 8 8     92   67    25   72 0,
         Node 8 9     86   73    13   84 0,
         Node 8 10    94   65    29   69 0,
         Node 8 11    90   69    21   76 0,
         Node 8 12    89   69    20   77 0,
         Node 8 13    89   73    16   82 0,
         Node 8 14    89   72    17   80 0,
         Node 8 15    92   73    19   79 0,
         Node 8 16    86   70    16   81 0,
         Node 8 17    92   67    25   72 0,
         Node 8 18    94   67    27   71 0,
         Node 8 19    91   65    26   71 0,
         Node 8 20    86   71    15   82 0,
         Node 8 21    87   69    18   79 0,
         Node 8 22    94   72    22   76 0,
         Node 8 23    94   73    21   77 0,
         Node 8 24    92   65    27   70 0,
         Node 8 25    91   65    26   71 0,
         Node 8 26    90   66    24   73 0,
         Node 8 27    85   71    14   83 0,
         Node 8 28    86   72    14   83 0,
         Node 8 29    85   71    14   83 0,
         Node 9 0     88   71    17   80 0,
         Node 9 1     91   70    21   76 0,
         Node 9 2     93   64    29   68 0,
         Node 9 3     89   66    23   74 0,
         Node 9 4     91   65    26   71 0,
         Node 9 5     91   64    27   70 0,
         Node 9 6     91   67    24   73 0,
         Node 9 7     94   69    25   73 0,
         Node 9 8     85   65    20   76 0,
         Node 9 9     94   70    24   74 0,
         Node 9 10    87   73    14   83 0,
         Node 9 11    89   64    25   71 0,
         Node 9 12    90   67    23   74 0,
         Node 9 13    87   72    15   82 0,
         Node 9 14    94   68    26   72 0,
         Node 9 15    85   65    20   76 0,
         Node 9 16    89   68    21   76 0,
         Node 9 17    89   70    19   78 0,
         Node 9 18    86   72    14   83 0,
         Node 9 19    86   68    18   79 0,
         Node 9 20    92   64    28   69 0,
         Node 9 21    92   73    19   79 0,
         Node 9 22    93   65    28   69 0,
         Node 9 23    88   71    17   80 0,
         Node 9 24    86   73    13   84 0,
         Node 9 25    88   73    15   82 0,
         Node 9 26    85   70    15   82 0,
         Node 9 27    90   68    22   75 0,
         Node 9 28    93   64    29   68 0,
         Node 9 29    91   67    24   73 0,
         Node 10 0    90   72    18   80 0,
         Node 10 1    90   70    20   77 0,
         Node 10 2    93   70    23   75 0,
         Node 10 3    87   66    21   75 0,
         Node 10 4    85   67    18   78 0,
         Node 10 5    87   66    21   75 0,
         Node 10 6    87   70    17   80 0,
         Node 10 7    93   65    28   69 0,
         Node 10 8    89   68    21   76 0,
         Node 10 9    88   69    19   78 0,
         Node 10 10   87   69    18   79 0,
         Node 10 11   92   67    25   72 0,
         Node 10 12   90   65    25   72 0,
         Node 10 13   94   64    30   68 0,
         Node 10 14   92   69    23   75 0,
         Node 10 15   89   73    16   82 0,
         Node 10 16   91   72    19   79 0,
         Node 10 17   90   71    19   78 0,
         Node 10 18   89   65    24   73 0,
         Node 10 19   93   67    26   72 0,
         Node 10 20   92   71    21   77 0,
         Node 10 21   93   65    28   69 0,
         Node 10 22   86   65    21   75 0,
         Node 10 23   93   73    20   78 0,
         Node 10 24   85   70    15   82 0,
         Node 10 25   87   70    17   80 0,
         Node 10 26   93   73    20   78 0,
         Node 10 27   92   65    27   70 0,
         Node 10 28   85   72    13   84 0,
         Node 10 29   86   70    16   81 0,
         Node 11 0    89   64    25   71 0,
         Node 11 1    86   72    14   83 0,
         Node 11 2    88   68    20   77 0,
         Node 11 3    86   70    16   81 0,
         Node 11 4    88   67    21   76 0,
         Node 11 5    93   67    26   72 0,
         Node 11 6    94   73    21   77 0,
         Node 11 7    91   65    26   71 0,
         Node 11 8    87   70    17   80 0,
         Node 11 9    88   73    15   82 0,
         Node 11 10   93   71    22   76 0,
         Node 11 11   92   65    27   70 0,
         Node 11 12   90   67    23   74 0,
         Node 11 13   92   68    24   73 0,
         Node 11 14   88   71    17   80 0,
         Node 11 15   85   69    16   81 0,
         Node 11 16   86   71    15   82 0,
         Node 11 17   92   67    25   72 0,
         Node 11 18   88   66    22   75 0,
         Node 11 19   90   70    20   77 0,
         Node 11 20   85   69    16   81 0,
         Node 11 21   91   65    26   71 0,
         Node 11 22   91   69    22   75 0,
         Node 11 23   85   71    14   83 0,
         Node 11 24   92   68    24   73 0,
         Node 11 25   94   71    23   75 0,
         Node 11 26   87   66    21   75 0,
         Node 11 27   93   70    23   75 0,
         Node 11 28   91   68    23   74 0,
         Node 11 29   90   66    24   73 0,
         Node 12 0    86   65    21   75 0,
         Node 12 1    93   73    20   78 0,
         Node 12 2    94   70    24   74 0,
         Node 12 3    89   70    19   78 0,
         Node 12 4    87   71    16   81 0,
         Node 12 5    87   65    22   74 0,
         Node 12 6    85   65    20   76 0,
         Node 12 7    86   73    13   84 0,
         Node 12 8    87   67    20   77 0,
         Node 12 9    89   66    23   74 0,
         Node 12 10   89   68    21   76 0,
         Node 12 11   88   69    19   78 0,
         Node 12 12   90   66    24   73 0,
         Node 12 13   94   65    29   69 0,
         Node 12 14   91   69    22   75 0,
         Node 12 15   89   71    18   79 0,
         Node 12 16   91   64    27   70 0,
         Node 12 17   86   73    13   84 0,
         Node 12 18   88   64    24   72 0,
         Node 12 19   92   64    28   69 0,
         Node 12 20   87   66    21   75 0,
         Node 12 21   90   72    18   80 0,
         Node 12 22   93   71    22   76 0,
         Node 12 23   85   73    12   85 0,
         Node 12 24   91   71    20   78 0,
         Node 12 25   92   71    21   77 0,
         Node 12 26   86   66    20   76 0,
         Node 12 27   87   65    22   74 0,
         Node 12 28   87   69    18   79 0,
         Node 12 29   90   67    23   74 0,
         Node 13 0    89   67    22   75 0,
         Node 13 1    87   68    19   78 0,
         Node 13 2    85   69    16   81 0,
         Node 13 3    88   66    22   75 0,
         Node 13 4    94   70    24   74 0,
         Node 13 5    89   68    21   76 0,
         Node 13 6    87   65    22   74 0,
         Node 13 7    87   66    21   75 0,
         Node 13 8    92   64    28   69 0,
         Node 13 9    91   70    21   76 0,
         Node 13 10   89   71    18   79 0,
         Node 13 11   89   67    22   75 0,
         Node 13 12   86   68    18   79 0,
         Node 13 13   85   71    14   83 0,
         Node 13 14   89   70    19   78 0,
         Node 13 15   93   70    23   75 0,
         Node 13 16   91   64    27   70 0,
         Node 13 17   90   73    17   81 0,
         Node 13 18   87   64    23   73 0,
         Node 13 19   85   68    17   80 0,
         Node 13 20   88   64    24   72 0,
         Node 13 21   85   67    18   78 0,
         Node 13 22   91   66    25   72 0,
         Node 13 23   86   70    16   81 0,
         Node 13 24   87   69    18   79 0,
         Node 13 25   91   73    18   80 0,
         Node 13 26   94   71    23   75 0,
         Node 13 27   94   67    27   71 0,
         Node 13 28   89   66    23   74 0,
         Node 13 29   90   66    24   73 0,
         Node 14 0    93   68    25   73 0,
         Node 14 1    85   68    17   80 0,
         Node 14 2    94   65    29   69 0,
         Node 14 3    88   66    22   75 0,
         Node 14 4    90   65    25   72 0,
         Node 14 5    89   65    24   73 0,
         Node 14 6    86   73    13   84 0,
         Node 14 7    94   66    28   70 0,
         Node 14 8    88   66    22   75 0,
         Node 14 9    86   72    14   83 0,
         Node 14 10   92   67    25   72 0,
         Node 14 11   88   66    22   75 0,
         Node 14 12   87   70    17   80 0,
         Node 14 13   91   68    23   74 0,
         Node 14 14   93   67    26   72 0,
         Node 14 15   91   68    23   74 0,
         Node 14 16   93   65    28   69 0,
         Node 14 17   85   65    20   76 0,
         Node 14 18   91   66    25   72 0,
         Node 14 19   85   68    17   80 0,
         Node 14 20   90   64    26   71 0,
         Node 14 21   86   68    18   79 0,
         Node 14 22   93   73    20   78 0,
         Node 14 23   85   67    18   78 0,
         Node 14 24   89   67    22   75 0,
         Node 14 25   93   65    28   69 0,
         Node 14 26   93   71    22   76 0,
         Node 14 27   90   70    20   77 0,
         Node 14 28   90   67    23   74 0,
         Node 14 29   92   70    22   76 0,
         Node 15 0    85   66    19   77 0,
         Node 15 1    87   72    15   82 0,
         Node 15 2    94   68    26   72 0,
         Node 15 3    94   71    23   75 0,
         Node 15 4    89   69    20   77 0,
         Node 15 5    88   66    22   75 0,
         Node 15 6    89   73    16   82 0,
         Node 15 7    88   67    21   76 0,
         Node 15 8    92   72    20   78 0,
         Node 15 9    89   72    17   80 0,
         Node 15 10   86   67    19   77 0,
         Node 15 11   86   66    20   76 0,
         Node 15 12   89   67    22   75 0,
         Node 15 13   88   66    22   75 0,
         Node 15 14   89   64    25   71 0,
         Node 15 15   90   70    20   77 0,
         Node 15 16   88   64    24   72 0,
         Node 15 17   90   70    20   77 0,
         Node 15 18   93   71    22   76 0,
         Node 15 19   94   64    30   68 0,
         Node 15 20   87   69    18   79 0,
         Node 15 21   92   69    23   75 0,
         Node 15 22   90   67    23   74 0,
         Node 15 23   92   64    28   69 0,
         Node 15 24   93   66    27   70 0,
         Node 15 25   93   70    23   75 0,
         Node 15 26   86   64    22   74 0,
         Node 15 27   89   65    24   73 0,
         Node 15 28   85   70    15   82 0,
         Node 15 29   88   66    22   75 0,
         Node 16 0    92   65    27   70 0,
         Node 16 1    88   65    23   73 0,
         Node 16 2    88   70    18   79 0,
         Node 16 3    92   73    19   79 0,
         Node 16 4    85   70    15   82 0,
         Node 16 5    87   72    15   82 0,
         Node 16 6    87   69    18   79 0,
         Node 16 7    86   69    17   80 0,
         Node 16 8    90   67    23   74 0,
         Node 16 9    90   66    24   73 0,
         Node 16 10   89   71    18   79 0,
         Node 16 11   94   71    23   75 0,
         Node 16 12   88   68    20   77 0,
         Node 16 13   93   70    23   75 0,
         Node 16 14   94   64    30   68 0,
         Node 16 15   89   66    23   74 0,
         Node 16 16   90   69    21   76 0,
         Node 16 17   86   68    18   79 0,
         Node 16 18   86   64    22   74 0,
         Node 16 19   90   70    20   77 0,
         Node 16 20   91   65    26   71 0,
         Node 16 21   93   71    22   76 0,
         Node 16 22   94   71    23   75 0,
         Node 16 23   90   68    22   75 0,
         Node 16 24   91   73    18   80 0,
         Node 16 25   87   69    18   79 0,
         Node 16 26   92   67    25   72 0,
         Node 16 27   91   67    24   73 0,
         Node 16 28   86   67    19   77 0,
         Node 16 29   92   70    22   76 0,
         Node 17 0    91   70    21   76 0,
         Node 17 1    90   69    21   76 0,
         Node 17 2    92   71    21   77 0,
         Node 17 3    85   68    17   80 0,
         Node 17 4    88   65    23   73 0,
         Node 17 5    93   69    24   74 0,
         Node 17 6    88   72    16   81 0,
         Node 17 7    91   64    27   70 0,
         Node 17 8    87   67    20   77 0,
         Node 17 9    87   66    21   75 0,
         Node 17 10   93   65    28   69 0,
         Node 17 11   94   73    21   77 0,
         Node 17 12   89   64    25   71 0,
         Node 17 13   89   67    22   75 0,
         Node 17 14   92   66    26   71 0,
         Node 17 15   85   66    19   77 0,
         Node 17 16   85   70    15   82 0,
         Node 17 17   87   72    15   82 0,
         Node 17 18   92   70    22   76 0,
         Node 17 19   86   73    13   84 0,
         Node 17 20   91   72    19   79 0,
         Node 17 21   92   73    19   79 0,
         Node 17 22   93   73    20   78 0,
         Node 17 23   85   73    12   85 0,
         Node 17 24   86   67    19   77 0,
         Node 17 25   87   70    17   80 0,
         Node 17 26   88   65    23   73 0,
         Node 17 27   94   64    30   68 0,
         Node 17 28   89   71    18   79 0,
         Node 17 29   92   65    27   70 0,
         Node 18 0    89   72    17   80 0,
         Node 18 1    90   70    20   77 0,
         Node 18 2    88   69    19   78 0,
         Node 18 3    94   68    26   72 0,
         Node 18 4    94   68    26   72 0,
         Node 18 5    94   73    21   77 0,
         Node 18 6    92   66    26   71 0,
         Node 18 7    87   71    16   81 0,
         Node 18 8    93   66    27   70 0,
         Node 18 9    88   67    21   76 0,
         Node 18 10   85   64    21   75 0,
         Node 18 11   90   66    24   73 0,
         Node 18 12   86   72    14   83 0,
         Node 18 13   89   68    21   76 0,
         Node 18 14   91   67    24   73 0,
         Node 18 15   90   71    19   78 0,
         Node 18 16   94   64    30   68 0,
         Node 18 17   86   66    20   76 0,
         Node 18 18   90   64    26   71 0,
         Node 18 19   87   73    14   83 0,
         Node 18 20   93   72    21   77 0,
         Node 18 21   94   64    30   68 0,
         Node 18 22   94   69    25   73 0,
         Node 18 23   93   71    22   76 0,
         Node 18 24   94   72    22   76 0,
         Node 18 25   85   68    17   80 0,
         Node 18 26   89   67    22   75 0,
         Node 18 27   89   72    17   80 0,
         Node 18 28   93   72    21   77 0,
         Node 18 29   87   64    23   73 0,
         Node 19 0    88   67    21   76 0,
         Node 19 1    90   70    20   77 0,
         Node 19 2    93   65    28   69 0,
         Node 19 3    90   67    23   74 0,
         Node 19 4    88   69    19   78 0,
         Node 19 5    93   64    29   68 0,
         Node 19 6    89   66    23   74 0,
         Node 19 7    85   66    19   77 0,
         Node 19 8    85   65    20   76 0,
         Node 19 9    86   65    21   75 0,
         Node 19 10   91   66    25   72 0,
         Node 19 11   91   64    27   70 0,
         Node 19 12   90   65    25   72 0,
         Node 19 13   89   65    24   73 0,
         Node 19 14   94   71    23   75 0,
         Node 19 15   85   72    13   84 0,
         Node 19 16   87   73    14   83 0,
         Node 19 17   94   73    21   77 0,
         Node 19 18   87   64    23   73 0,
         Node 19 19   91   68    23   74 0,
         Node 19 20   89   66    23   74 0,
         Node 19 21   88   69    19   78 0,
         Node 19 22   88   70    18   79 0,
         Node 19 23  505  499     6   98 0,
         Node 19 24   88   73    15   82 0,
         Node 19 25   94   66    28   70 0,
         Node 19 26   85   68    17   80 0,
         Node 19 27   94   69    25   73 0,
         Node 19 28   94   65    29   69 0,
         Node 19 29   87   64    23   73 0,
         Node 20 0    85   72    13   84 0,
         Node 20 1    87   70    17   80 0,
         Node 20 2    93   66    27   70 0,
         Node 20 3    86   66    20   76 0,
         Node 20 4    89   67    22   75 0,
         Node 20 5    92   70    22   76 0,
         Node 20 6    85   70    15   82 0,
         Node 20 7    89   68    21   76 0,
         Node 20 8    86   70    16   81 0,
         Node 20 9    90   71    19   78 0,
         Node 20 10   93   73    20   78 0,
         Node 20 11   91   73    18   80 0,
         Node 20 12   92   70    22   76 0,
         Node 20 13   91   73    18   80 0,
         Node 20 14   88   66    22   75 0,
         Node 20 15   93   69    24   74 0,
         Node 20 16   85   73    12   85 0,
         Node 20 17   94   64    30   68 0,
         Node 20 18   90   68    22   75 0,
         Node 20 19   93   73    20   78 0,
         Node 20 20   85   68    17   80 0,
         Node 20 21   87   72    15   82 0,
         Node 20 22   93   70    23   75 0,
         Node 20 23  506  492    14   97 0,
         Node 20 24   85   66    19   77 0,
         Node 20 25   94   70    24   74 0,
         Node 20 26   94   66    28   70 0,
         Node 20 27   87   65    22   74 0,
         Node 20 28   93   71    22   76 0,
         Node 20 29   90   71    19   78 0,
         Node 21 0    93   71    22   76 0,
         Node 21 1    85   65    20   76 0,
         Node 21 2    89   73    16   82 0,
         Node 21 3    86   69    17   80 0,
         Node 21 4    89   72    17   80 0,
         Node 21 5    85   71    14   83 0,
         Node 21 6    91   69    22   75 0,
         Node 21 7    86   67    19   77 0,
         Node 21 8    90   64    26   71 0,
         Node 21 9    94   64    30   68 0,
         Node 21 10   91   65    26   71 0,
         Node 21 11   93   69    24   74 0,
         Node 21 12   88   71    17   80 0,
         Node 21 13   94   69    25   73 0,
         Node 21 14   92   69    23   75 0,
         Node 21 15   85   71    14   83 0,
         Node 21 16   94   73    21   77 0,
         Node 21 17   92   68    24   73 0,
         Node 21 18   90   65    25   72 0,
         Node 21 19   93   64    29   68 0,
         Node 21 20   93   70    23   75 0,
         Node 21 21   94   68    26   72 0,
         Node 21 22   91   71    20   78 0,
         Node 21 23  506  496    10   98 0,
         Node 21 24   92   65    27   70 0,
         Node 21 25   92   68    24   73 0,
         Node 21 26   94   70    24   74 0,
         Node 21 27   85   64    21   75 0,
         Node 21 28   90   68    22   75 0,
         Node 21 29   87   72    15   82 0,
         Node 22 0    90   72    18   80 0,
         Node 22 1    88   68    20   77 0,
         Node 22 2    92   67    25   72 0,
         Node 22 3    85   65    20   76 0,
         Node 22 4    86   70    16   81 0,
         Node 22 5    85   73    12   85 0,
         Node 22 6    89   73    16   82 0,
         Node 22 7    94   71    23   75 0,
         Node 22 8    93   73    20   78 0,
         Node 22 9    92   72    20   78 0,
         Node 22 10   91   69    22   75 0,
         Node 22 11   92   73    19   79 0,
         Node 22 12   92   64    28   69 0,
         Node 22 13   90   67    23   74 0,
         Node 22 14   86   71    15   82 0,
         Node 22 15   89   65    24   73 0,
         Node 22 16   93   69    24   74 0,
         Node 22 17   91   72    19   79 0,
         Node 22 18   94   73    21   77 0,
         Node 22 19   86   68    18   79 0,
         Node 22 20   93   70    23   75 0,
         Node 22 21   93   66    27   70 0,
         Node 22 22   93   65    28   69 0,
         Node 22 23  502  494     8   98 0,
         Node 22 24   86   73    13   84 0,
         Node 22 25   91   66    25   72 0,
         Node 22 26   88   68    20   77 0,
         Node 22 27   87   70    17   80 0,
         Node 22 28   88   73    15   82 0,
         Node 22 29   90   67    23   74 0,
         Node 23 0    89   69    20   77 0,
         Node 23 1    87   71    16   81 0,
         Node 23 2    89   69    20   77 0,
         Node 23 3    93   70    23   75 0,
         Node 23 4    87   71    16   81 0,
         Node 23 5    91   70    21   76 0,
         Node 23 6    88   72    16   81 0,
         Node 23 7    91   65    26   71 0,
         Node 23 8    93   73    20   78 0,
         Node 23 9    93   65    28   69 0,
         Node 23 10   91   67    24   73 0,
         Node 23 11   89   69    20   77 0,
         Node 23 12   94   71    23   75 0,
         Node 23 13   86   68    18   79 0,
         Node 23 14   88   73    15   82 0,
         Node 23 15   92   64    28   69 0,
         Node 23 16   89   72    17   80 0,
         Node 23 17   91   68    23   74 0,
         Node 23 18   92   71    21   77 0,
         Node 23 19   89   69    20   77 0,
         Node 23 20   88   67    21   76 0,
         Node 23 21   89   64    25   71 0,
         Node 23 22   90   64    26   71 0,
         Node 23 23  504  499     5   99 0,
         Node 23 24   89   73    16   82 0,
         Node 23 25   88   70    18   79 0,
         Node 23 26   90   69    21   76 0,
         Node 23 27   92   72    20   78 0,
         Node 23 28   89   66    23   74 0,
         Node 23 29   94   65    29   69 0,
         Node 24 0    93   71    22   76 0,
         Node 24 1    88   64    24   72 0,
         Node 24 2    88   65    23   73 0,
         Node 24 3    87   72    15   82 0,
         Node 24 4    91   69    22   75 0,
         Node 24 5    92   67    25   72 0,
         Node 24 6    93   68    25   73 0,
         Node 24 7    87   67    20   77 0,
         Node 24 8    93   64    29   68 0,
         Node 24 9    92   67    25   72 0,
         Node 24 10   93   69    24   74 0,
         Node 24 11   92   69    23   75 0,
         Node 24 12   93   68    25   73 0,
         Node 24 13   87   67    20   77 0,
         Node 24 14   85   65    20   76 0,
         Node 24 15   90   70    20   77 0,
         Node 24 16   93   65    28   69 0,
         Node 24 17   88   65    23   73 0,
         Node 24 18   86   68    18   79 0,
         Node 24 19   85   71    14   83 0,
         Node 24 20   94   69    25   73 0,
         Node 24 21   88   66    22   75 0,
         Node 24 22   89   73    16   82 0,
         Node 24 23  506  496    10   98 0,
         Node 24 24   90   71    19   78 0,
         Node 24 25   93   72    21   77 0,
         Node 24 26   94    0    94    0 0,
         Node 24 27   85   67    18   78 0,
         Node 24 28   87   69    18   79 0,
         Node 24 29   88   71    17   80 0,
         Node 25 0    87   64    23   73 0,
         Node 25 1    91   64    27   70 0,
         Node 25 2    93   71    22   76 0,
         Node 25 3    93   70    23   75 0,
         Node 25 4    86   67    19   77 0,
         Node 25 5    92   64    28   69 0,
         Node 25 6    92   65    27   70 0,
         Node 25 7    85   68    17   80 0,
         Node 25 8    85   67    18   78 0,
         Node 25 9    85   67    18   78 0,
         Node 25 10   91   65    26   71 0,
         Node 25 11   87   68    19   78 0,
         Node 25 12   87   70    17   80 0,
         Node 25 13   89   73    16   82 0,
         Node 25 14   88   66    22   75 0,
         Node 25 15   85   68    17   80 0,
         Node 25 16   91   73    18   80 0,
         Node 25 17   88   73    15   82 0,
         Node 25 18   88   71    17   80 0,
         Node 25 19   94   66    28   70 0,
         Node 25 20   92   67    25   72 0,
         Node 25 21   90   65    25   72 0,
         Node 25 22   88   68    20   77 0,
         Node 25 23  506  494    12   97 0,
         Node 25 24   92   64    28   69 0,
         Node 25 25   92   68    24   73 0,
         Node 25 26   89   68    21   76 0,
         Node 25 27   85   64    21   75 0,
         Node 25 28   93   68    25   73 0,
         Node 25 29   93   68    25   73 0,
         Node 26 0    93   72    21   77 0,
         Node 26 1    90   68    22   75 0,
         Node 26 2    87   69    18   79 0,
         Node 26 3    91   66    25   72 0,
         Node 26 4    94   68    26   72 0,
         Node 26 5    87   64    23   73 0,
         Node 26 6    93   65    28   69 0,
         Node 26 7    91   64    27   70 0,
         Node 26 8    90   68    22   75 0,
         Node 26 9    92   69    23   75 0,
         Node 26 10   93   73    20   78 0,
         Node 26 11   88   68    20   77 0,
         Node 26 12   92   70    22   76 0,
         Node 26 13   86   67    19   77 0,
         Node 26 14   88   70    18   79 0,
         Node 26 15   88   68    20   77 0,
         Node 26 16   92   72    20   78 0,
         Node 26 17   89   65    24   73 0,
         Node 26 18   87   71    16   81 0,
         Node 26 19   88   67    21   76 0,
         Node 26 20   89   72    17   80 0,
         Node 26 21   85   64    21   75 0,
         Node 26 22   86   72    14   83 0,
         Node 26 23  509  497    12   97 0,
         Node 26 24   94   67    27   71 0,
         Node 26 25   86   70    16   81 0,
         Node 26 26   90   70    20   77 0,
         Node 26 27   87   68    19   78 0,
         Node 26 28   90   72    18   80 0,
         Node 26 29   85   73    12   85 0,
         Node 27 0    93   67    26   72 0,
         Node 27 1    89   69    20   77 0,
         Node 27 2    87   65    22   74 0,
         Node 27 3    89   65    24   73 0,
         Node 27 4    91   71    20   78 0,
         Node 27 5    91   69    22   75 0,
         Node 27 6    93   72    21   77 0,
         Node 27 7    90   70    20   77 0,
         Node 27 8    91   64    27   70 0,
         Node 27 9    85   68    17   80 0,
         Node 27 10   88   70    18   79 0,
         Node 27 11   90   66    24   73 0,
         Node 27 12   92   64    28   69 0,
         Node 27 13   87   64    23   73 0,
         Node 27 14   93   68    25   73 0,
         Node 27 15   88   69    19   78 0,
         Node 27 16   86   73    13   84 0,
         Node 27 17   91   68    23   74 0,
         Node 27 18   89   72    17   80 0,
         Node 27 19   87   66    21   75 0,
         Node 27 20   89   71    18   79 0,
         Node 27 21   93   69    24   74 0,
         Node 27 22   87   72    15   82 0,
         Node 27 23  508  492    16   96 0,
         Node 27 24   85   73    12   85 0,
         Node 27 25   92   64    28   69 0,
         Node 27 26   91   72    19   79 0,
         Node 27 27   89   72    17   80 0,
         Node 27 28   88   66    22   75 0,
         Node 27 29   85   64    21   75 0,
         Node 28 0    94   66    28   70 0,
         Node 28 1    87   71    16   81 0,
         Node 28 2    94   65    29   69 0,
         Node 28 3    86   67    19   77 0,
         Node 28 4    85   68    17   80 0,
         Node 28 5    94   70    24   74 0,
         Node 28 6    93   65    28   69 0,
         Node 28 7    85   66    19   77 0,
         Node 28 8    87   72    15   82 0,
         Node 28 9    87   68    19   78 0,
         Node 28 10   88   68    20   77 0,
         Node 28 11   92   70    22   76 0,
         Node 28 12   91   70    21   76 0,
         Node 28 13   92   65    27   70 0,
         Node 28 14   88   68    20   77 0,
         Node 28 15   92   64    28   69 0,
         Node 28 16   90   66    24   73 0,
         Node 28 17   91   67    24   73 0,
         Node 28 18   89   72    17   80 0,
         Node 28 19   86   69    17   80 0,
         Node 28 20   94   64    30   68 0,
         Node 28 21   87   64    23   73 0,
         Node 28 22   86   72    14   83 0,
         Node 28 23  504  492    12   97 0,
         Node 28 24   85   65    20   76 0,
         Node 28 25   94   65    29   69 0,
         Node 28 26   87   73    14   83 0,
         Node 28 27   88   65    23   73 0,
         Node 28 28   92   72    20   78 0,
         Node 28 29   89   72    17   80 0,
         Node 29 0    89   67    22   75 0,
         Node 29 1    85   65    20   76 0,
         Node 29 2    90   68    22   75 0,
         Node 29 3    88   69    19   78 0,
         Node 29 4    89   65    24   73 0,
         Node 29 5    85   65    20   76 0,
         Node 29 6    91   73    18   80 0,
         Node 29 7    90   68    22   75 0,
         Node 29 8    85   64    21   75 0,
         Node 29 9    88   73    15   82 0,
         Node 29 10   89   73    16   82 0,
         Node 29 11   89   65    24   73 0,
         Node 29 12   94   64    30   68 0,
         Node 29 13   90   73    17   81 0,
         Node 29 14   91   67    24   73 0,
         Node 29 15   86   73    13   84 0,
         Node 29 16   94   65    29   69 0,
         Node 29 17   93   64    29   68 0,
         Node 29 18   87   72    15   82 0,
         Node 29 19   87   73    14   83 0,
         Node 29 20   87   66    21   75 0,
         Node 29 21   86   70    16   81 0,
         Node 29 22   92   67    25   72 0,
         Node 29 23  502  498     4   99 0,
         Node 29 24   87   67    20   77 0,
         Node 29 25   88   67    21   76 0,
         Node 29 26   88   69    19   78 0,
         Node 29 27   86   67    19   77 0,
         Node 29 28   86   66    20   76 0,
         Node 29 29   87   64    23   73 0,
         Node 30 0    89   67    22   75 0,
         Node 30 1    94   71    23   75 0,
         Node 30 2    92   69    23   75 0,
         Node 30 3    86   67    19   77 0,
         Node 30 4    85   72    13   84 0,
         Node 30 5    92   68    24   73 0,
         Node 30 6    92   73    19   79 0,
         Node 30 7    85   67    18   78 0,
         Node 30 8    85   69    16   81 0,
         Node 30 9    93   64    29   68 0,
         Node 30 10   85   73    12   85 0,
         Node 30 11   87   66    21   75 0,
         Node 30 12   91   72    19   79 0,
         Node 30 13   85   71    14   83 0,
         Node 30 14   89   65    24   73 0,
         Node 30 15   93   71    22   76 0,
         Node 30 16   92   72    20   78 0,
         Node 30 17   85   66    19   77 0,
         Node 30 18   88   70    18   79 0,
         Node 30 19   88   67    21   76 0,
         Node 30 20   85   70    15   82 0,
         Node 30 21   92   73    19   79 0,
         Node 30 22   85   71    14   83 0,
         Node 30 23  503  494     9   98 0,
         Node 30 24   88   67    21   76 0,
         Node 30 25   94   71    23   75 0,
         Node 30 26   91   71    20   78 0,
         Node 30 27   89   71    18   79 0,
         Node 30 28   93   71    22   76 0,
         Node 30 29   91   72    19   79 0,
         Node 31 0    89   71    18   79 71,
         Node 31 1    92   72    20   78 0,
         Node 31 2    93   65    28   69 0,
         Node 31 3    87   72    15   82 0,
         Node 31 4    85   70    15   82 0,
         Node 31 5    94   73    21   77 0,
         Node 31 6    87   65    22   74 0,
         Node 31 7    86   64    22   74 0,
         Node 31 8    94   69    25   73 0,
         Node 31 9    86   69    17   80 0,
         Node 31 10   88   65    23   73 0,
         Node 31 11   88   71    17   80 0,
         Node 31 12   89   67    22   75 0,
         Node 31 13   87   66    21   75 0,
         Node 31 14   87   70    17   80 0,
         Node 31 15   93   65    28   69 0,
         Node 31 16   86   70    16   81 0,
         Node 31 17   88   64    24   72 0,
         Node 31 18   88   68    20   77 0,
         Node 31 19   93   66    27   70 0,
         Node 31 20   89   68    21   76 0,
         Node 31 21   90   70    20   77 0,
         Node 31 22   85   66    19   77 0,
         Node 31 23  510  496    14   97 0,
         Node 31 24   90   69    21   76 0,
         Node 31 25   89   68    21   76 0,
         Node 31 26   93   64    29   68 0,
         Node 31 27   87   71    16   81 0,
         Node 31 28   93   70    23   75 0,
         Node 31 29   86   72    14   83 0]

ix    (Node i _ _ _ _ _ _) = i
iy    (Node _ i _ _ _ _ _) = i
total (Node _ _ t _ _ _ _) = t
used  (Node _ _ _ u _ _ _) = u
avail (Node _ _ _ _ a _ _) = a
pct   (Node _ _ _ _ _ p _) = p
goal  (Node _ _ _ _ _ _ g) = g

canMove :: [Node] -> Node -> Bool
canMove nodes node = any canMove' adjacent
  where adjacent = neighbors nodes node
        canMove' target = avail target >= used node

tooLarge :: [Node] -> Node -> Bool
tooLarge nodes node = any tooLargeFor' adjacent
  where adjacent = neighbors nodes node
        tooLargeFor' target = used node > total target

isZero :: Node -> Bool
isZero node = used node == 0

neighbors :: [Node] -> Node -> [Node]
neighbors nodes node = filter (neighbor node) nodes
neighbor node possible = 1 == (abs (ny - py) + abs (nx - px))
  where nx = ix node
        ny = iy node
        px = ix possible
        py = iy possible

without x = filter (/= x)

pairs :: [Node] -> [(Node, Node)]
pairs nodes = concatMap matchups nodes
  where matchups n = repeat n `zip` without n nodes

isNodeAt x y n = (ix n == x) && (iy n == y)

headMaybe :: [a] -> Maybe a
headMaybe [] = Nothing
headMaybe (h:_) = Just h

nodeAt x y nodes = headMaybe $ filter (isNodeAt x y) nodes

render :: [Node] -> String
render nodes = intercalate "\n" lines
  where maxX = maxBy ix nodes
        maxY = maxBy iy nodes
        lines = map renderRow indices
        renderRow = map (renderNode nodes . node)
        node (x, y) = nodeAt x y nodes
        indices = [ [ (i, j) | i <- [0 .. maxX] ]
                             | j <- [0 .. maxY] ]

renderNode :: [Node] -> Maybe Node -> Char
renderNode _  Nothing  = ' '
renderNode ns (Just n) = if goal n > 0         then 'X'
                         else if isZero n      then 'O'
                         else if canMove ns n  then '+'
                         else if tooLarge ns n then '#'
                         else                       '.'

maxBy :: (Ord b, Bounded b) => (a -> b) -> [a] -> b
maxBy f = foldl max minBound . map f

-- moves = s

-- prepare :: [Node] -> [[Node]]

-- loopAround :: [Node] -> [[Node]]
-- loopAround nodes states = 

shift :: [Node] -> [[Node]]
shift nodes = [moveData from to nodes]
  where from = head $ filter ((/= 0) . goal) nodes
        to = head $ filter ((== 0) . used) nodes

moveData :: Node -> Node -> [Node] -> [Node]
moveData from to nodes = others ++ []
  where (elems, others) = partition ((== from) .|. (== to)) nodes
        (fromA, toA) = move from to
        move containing @ (Node cx cy cs cu ca cp cg)
             other      @ (Node ox oy os ou oa op og)
             | (oa < cu)             = error $ "impossible to move."
             | (cg > 0) && (og == 0) = (Node cx cy cs 0 cs 0 0, Node ox oy os (ou + cu) (os - (ou + cu)) ((ou + cu) `quot` os) (cg + og))
             | otherwise             = error $ "no conditions met. can't move."

notElem x = not . (x `elem`)

(.|.) :: (a -> Bool) -> (a -> Bool) -> a -> Bool
(.|.) f g a = f a || g a

(.&.) :: (a -> Bool) -> (a -> Bool) -> a -> Bool
(.&.) f g a = f a && g a

main = do putStrLn "Board:"
          putStrLn ""
          putStrLn $ render start
          putStrLn ""
          putStrLn "Total Moves to get Goal (30, 1) to (0, 0)"
          -- print $ length $ moves
